<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/common/ProtectedRoute.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/common/ProtectedRoute.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview Protected Route Component
 * 
 * A route wrapper component that enforces authentication requirements for protected
 * pages. Automatically redirects unauthenticated users to the login page while
 * preserving the intended destination for post-login navigation.
 * 
 * Features:
 * - Authentication state checking via AuthContext
 * - Automatic redirect to login for unauthenticated users
 * - Loading state handling during auth verification
 * - Preservation of intended destination URL
 * - Replace navigation to prevent back button issues
 * - Animated loading spinner
 * 
 * Security Patterns:
 * - Client-side route protection
 * - JWT token validation via AuthContext
 * - Automatic session verification on mount
 * - Graceful handling of expired tokens
 * 
 * User Experience Flow:
 * 1. User attempts to access protected route
 * 2. Component checks authentication status
 * 3. If loading: Show spinner
 * 4. If unauthenticated: Redirect to login with return URL
 * 5. If authenticated: Render protected content
 * 6. After login: Redirect back to original destination
 * 
 * Integration Requirements:
 * - Must be wrapped in AuthProvider
 * - Requires React Router (Navigate, useLocation)
 * - Works with AuthContext hooks
 * 
 * @module components/common/ProtectedRoute
 * @requires react
 * @requires react-router-dom
 * @requires ../../context/AuthContext
 * 
 * @author mr.shaan
 * @version 1.0.0
 * @since 2025-12-16
 * 
 * @example
 * // Protect a single route
 * &lt;Route
 *   path="/dashboard"
 *   element={
 *     &lt;ProtectedRoute>
 *       &lt;Dashboard />
 *     &lt;/ProtectedRoute>
 *   }
 * />
 * 
 * @example
 * // Protect multiple routes
 * &lt;Route
 *   path="/admin/*"
 *   element={
 *     &lt;ProtectedRoute>
 *       &lt;AdminLayout />
 *     &lt;/ProtectedRoute>
 *   }
 * >
 *   &lt;Route path="users" element={&lt;Users />} />
 *   &lt;Route path="settings" element={&lt;Settings />} />
 * &lt;/Route>
 * 
 * @example
 * // Complete routing setup
 * function App() {
 *   return (
 *     &lt;AuthProvider>
 *       &lt;BrowserRouter>
 *         &lt;Routes>
 *           &lt;Route path="/login" element={&lt;Login />} />
 *           &lt;Route path="/signup" element={&lt;Signup />} />
 *           
 *           &lt;Route
 *             path="/dashboard"
 *             element={
 *               &lt;ProtectedRoute>
 *                 &lt;Dashboard />
 *               &lt;/ProtectedRoute>
 *             }
 *           />
 *         &lt;/Routes>
 *       &lt;/BrowserRouter>
 *     &lt;/AuthProvider>
 *   );
 * }
 */

import React from 'react';
import { Navigate, useLocation } from 'react-router-dom';
import { useAuth } from '../../context/AuthContext';


/**
 * ProtectedRoute Component
 * 
 * A Higher-Order Component (HOC) pattern that wraps protected routes and
 * enforces authentication requirements. Handles three distinct states:
 * loading, authenticated, and unauthenticated.
 * 
 * Component Logic Flow:
 * 
 * State 1 - Loading:
 * - Authentication status being verified
 * - Token validation in progress
 * - Display loading spinner
 * - Prevent rendering of protected content
 * 
 * State 2 - Unauthenticated:
 * - No valid token found
 * - Token expired or invalid
 * - Redirect to login page
 * - Save current location for return navigation
 * 
 * State 3 - Authenticated:
 * - Valid token confirmed
 * - User session active
 * - Render protected content (children)
 * 
 * Navigation Strategy:
 * - Uses `replace` to prevent back button from returning to protected route
 * - Saves `from` location in navigation state for post-login redirect
 * - Preserves query parameters and hash in return URL
 * 
 * Security Notes:
 * - Client-side protection only (not a replacement for API auth)
 * - Always validate on server-side as well
 * - Token stored securely in AuthContext/localStorage
 * - Automatic cleanup on token expiration
 * 
 * @component
 * @param {Object} props - Component properties
 * @param {React.ReactNode} props.children - Protected content to render when authenticated
 * 
 * @returns {React.ReactElement} Loading spinner, redirect, or protected content
 * 
 * @throws {Error} If used outside AuthProvider context
 * 
 * @example
 * // Basic usage with a component
 * &lt;ProtectedRoute>
 *   &lt;UserProfile />
 * &lt;/ProtectedRoute>
 * 
 * @example
 * // With nested routes
 * &lt;ProtectedRoute>
 *   &lt;Routes>
 *     &lt;Route path="profile" element={&lt;Profile />} />
 *     &lt;Route path="settings" element={&lt;Settings />} />
 *   &lt;/Routes>
 * &lt;/ProtectedRoute>
 * 
 * @example
 * // Accessing saved location after login
 * function LoginPage() {
 *   const location = useLocation();
 *   const navigate = useNavigate();
 *   const { login } = useAuth();
 *   
 *   const handleLogin = async (credentials) => {
 *     await login(credentials);
 *     // Redirect to saved location or default
 *     const from = location.state?.from?.pathname || '/dashboard';
 *     navigate(from, { replace: true });
 *   };
 * }
 */
const ProtectedRoute = ({ children }) => {
  /**
   * Authentication state from context
   * @type {Object}
   * @property {boolean} isAuthenticated - True if user has valid token
   * @property {boolean} loading - True during auth verification
   */
  const { isAuthenticated, loading } = useAuth();
  
  /**
   * Current location object from React Router
   * Used to preserve intended destination for post-login redirect
   * @type {Location}
   * @property {string} pathname - Current URL path
   * @property {string} search - Query parameters
   * @property {string} hash - URL hash
   */
  const location = useLocation();


  /**
   * Loading State Render
   * 
   * Displayed while authentication status is being verified.
   * Prevents flash of protected content before auth check completes.
   * 
   * Loading scenarios:
   * - Initial app load with stored token
   * - Token validation API call in progress
   * - Session verification with backend
   * 
   * Spinner Design:
   * - Full screen centered layout
   * - Tailwind CSS animations
   * - Primary brand color
   * - Accessible (respects prefers-reduced-motion)
   */
  if (loading) {
    return (
      &lt;div 
        className="min-h-screen flex items-center justify-center"
        role="status"
        aria-live="polite"
        aria-label="Loading authentication status"
      >
        &lt;div 
          className="animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"
          aria-hidden="true"
        />
        &lt;span className="sr-only">Verifying authentication...&lt;/span>
      &lt;/div>
    );
  }


  /**
   * Unauthenticated State Render
   * 
   * Redirects to login page when user is not authenticated.
   * Preserves current location for post-login navigation.
   * 
   * Navigation Details:
   * - to="/login": Redirect destination
   * - state={{ from: location }}: Save current location
   * - replace: Replace history entry (prevent back button issues)
   * 
   * Post-Login Flow:
   * 1. User lands on protected route
   * 2. Redirected to /login with state
   * 3. After successful login, redirect to saved location
   * 4. User seamlessly continues to intended destination
   * 
   * Security Considerations:
   * - Only stores pathname, not sensitive data
   * - Location state cleared after successful login
   * - No token information exposed in navigation
   */
  if (!isAuthenticated) {
    return (
      &lt;Navigate 
        to="/login" 
        state={{ from: location }} 
        replace 
      />
    );
  }


  /**
   * Authenticated State Render
   * 
   * User is authenticated - render the protected content.
   * Children can be any React component or element.
   * 
   * Common children types:
   * - Single component: &lt;Dashboard />
   * - Layout wrapper: &lt;AdminLayout>&lt;Routes>...&lt;/Routes>&lt;/AdminLayout>
   * - Nested routes: &lt;Routes>...&lt;/Routes>
   * 
   * At this point:
   * - Valid JWT token confirmed
   * - User session active
   * - AuthContext provides user data
   * - Protected API calls will succeed
   */
  return children;
};


export default ProtectedRoute;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-components_auth_LoginForm.html">components/auth/LoginForm</a></li><li><a href="module-components_auth_SignupForm.html">components/auth/SignupForm</a></li><li><a href="module-components_common_Input.html">components/common/Input</a></li><li><a href="module-components_common_ProtectedRoute.html">components/common/ProtectedRoute</a></li><li><a href="module-components_layout_Header.html">components/layout/Header</a></li><li><a href="module-context_AuthContext.html">context/AuthContext</a></li><li><a href="module-services_ApiClient.html">services/ApiClient</a></li><li><a href="module-services_AuthService.html">services/AuthService</a></li><li><a href="module-utils_TokenManager.html">utils/TokenManager</a></li></ul><h3>Classes</h3><ul><li><a href="module-services_ApiClient-ApiClient.html">ApiClient</a></li><li><a href="module-services_AuthService-AuthService.html">AuthService</a></li><li><a href="module-utils_TokenManager-TokenManager.html">TokenManager</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Tue Dec 16 2025 02:17:08 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
